# AI心臓システム ファイル構成概要

このドキュメントでは、AI心臓システムを構成する各ファイルの役割と機能について説明します。システムの全体像を把握し、各コンポーネントの関係性を理解するためのガイドとしてご活用ください。

## コアファイル

### GEMINI.md
AI心臓システムの中核となる仕様書です。AIの動作原則、処理フロー、思考ログ管理などの基本ルールが記載されています。AIはこのファイルに従って自律的に動作します。

主な内容:
- システムトリガー（ハートビート）の仕組み
- 能動モード/受動モードの処理フロー
- 思考ログ記録のルールとフォーマット
- 停止条件とテーマ移行条件
- 運用原則とエラーハンドリング

### heartbeat.sh
AI心臓システムの「鼓動」を生成するスクリプトです。定期的にAIに対してハートビート信号を送信し、自律的な思考を促します。

主な機能:
- 定期的なハートビート（プロンプト）送信
- Web検索制限の管理（クォータ保護）
- 無活動検知による自動停止機能
- ログ出力と状態表示

### setup.sh
システムの初期設定と起動を行うスクリプトです。tmuxセッションの作成、AIエージェントの起動、初期プロンプトの送信などを行います。

主な機能:
- 既存セッションのクリーンアップ
- agentセッションとheartbeatセッションの作成
- AIエージェントの起動と初期プロンプト実行
- ハートビートの開始

### stop.sh
ハートビートを停止するためのシンプルなスクリプトです。heartbeatセッションに対してCtrl+C信号を送信します。

### restart.sh
ハートビートを再起動するためのスクリプトです。AIエージェント自体は継続したまま、ハートビート送信のみを再開します。

主な機能:
- 現在のハートビートプロセスを停止（Ctrl+C送信）
- 2秒待機後にheartbeat.shを再実行
- システム全体を再起動せずにハートビートのみリセット

## サポートファイル

## AI向けドキュメント

### ai-docs/TROUBLESHOOTING_GUIDE.md
システム運用中に発生する可能性のある問題に対処するためのトラブルシューティングガイドです。AIがエラーやトラブルに遭遇した際に参照するドキュメントです。

主な内容:
- システムで使用されるツールの技術的な詳細と一般的な問題の解決方法
- エラー発生時の診断手順と対処法
- 思考ログ管理における特殊ケースへの対応方法
- システムのパフォーマンスを最適化するための高度な設定とノウハウ

### ai-docs/THEME_HISTORY_GUIDE.md
テーマの開始・終了時の履歴記録方法を定義するガイドです。AIがテーマを変更する際の記録ルールと、テーマの変遷を追跡するためのファイル管理方法が記載されています。

主な内容:
- テーマ開始・終了時の記録タイミングとルール
- 履歴ファイルの命名規則とフォーマット
- `artifacts/theme_histories/` ディレクトリでの履歴管理方法
- テーマ移行時の記録手順

### ai-docs/OPERATION_DETAILS.md
AI心臓システムの運用時に参照する詳細な手順とルールを定義するガイドです。GEMINI.mdから分離された詳細ルールが記載されており、必要時にのみ参照されます。

主な内容:
- 思考ログ管理の詳細（ファイル名形式、記録内容のフォーマット）
- Web検索ツール使用制限の詳細手順とクォータ対応
- ファイル操作制限の詳細（許可範囲と禁止事項）
- エラーハンドリングの詳細手順（連続エラー判定、停止記録）
- 思考ログ記録後の制限ルール詳細

### ai-docs/GUIDELINES.md
AI心臓システムの運用における指針と原則を定義するガイドです。システムの理念に基づいた運用方法や、効果的な思考サイクルの実現方法が記載されています。

主な内容:
- ハートビート単位での思考深度に関する指針
- 連続処理の例外ルールと適用条件
- 継続とバランスの原則（処理種別の循環）
- 実行タスクの柔軟性（補助的ツール利用）
- 自己評価と改善の指針
- トラブル時の心構えと対処姿勢

## ディレクトリ構造

### artifacts/
AIが生成したアウトプットを保存するディレクトリです。テーマごとにサブディレクトリが作成され、その中に思考ログや成果物が保存されます。

構造:
- `artifacts/{テーマ名}/` - テーマごとの成果物
- `artifacts/{テーマ名}/histories/` - 思考ログファイル
- `artifacts/theme_histories/` - テーマ開始・終了の履歴記録ファイル

### stats/
Web検索制限などのシステム状態を管理するためのファイルを格納するディレクトリです。

主なファイル:
- `last_web_search.txt` - 最後のWeb検索時刻を記録（通常制限用）
- `quota_exceeded.txt` - クォータ制限超過時に作成（長時間制限用）

### ai-docs/
AI向けの詳細ドキュメントを格納するディレクトリです。

主なファイル:
- `TROUBLESHOOTING_GUIDE.md` - AIのトラブルシューティングガイド
- `THEME_HISTORY_GUIDE.md` - テーマ履歴記録ガイド
- `OPERATION_DETAILS.md` - 運用詳細ガイド（GEMINI.mdから分離された詳細ルール）
- `GUIDELINES.md` - 運用ガイドライン（システム理念に基づく指針）

### themebox/
新しいテーマを事前に準備しておくためのディレクトリです。AIがテーマ移行を判断した際に、このディレクトリ内のファイルから次のテーマを自動選択します。

ファイル管理ルール:
- ファイル名は自由（優先順位はソート順、連番推奨）
- `draft.` プレフィックス: 編集中のファイル（無視される）
- `processed.` プレフィックス: 使用済みファイル（無視される）
- ファイル内容: そのまま新テーマとして使用される

## システムフロー概要

1. `setup.sh` を実行してシステムを初期化し、AIエージェントとハートビートプロセスを起動します
2. `heartbeat.sh` が定期的にAIエージェントにハートビート信号を送信します
3. AIエージェントは `GEMINI.md` に定義されたルールに従って自律的に処理を実行します
4. 問題が発生した場合は `TROUBLESHOOTING_GUIDE.md` を参照して診断・解決します
5. システムを停止する場合は `stop.sh` を実行してハートビートプロセスを終了します

## ファイル間の関係

- `GEMINI.md` - システムの中核となる仕様書で、AIエージェントの動作ルールを定義
- `heartbeat.sh` - 定期的な起動信号を送信するスクリプト
- `setup.sh` - システムの初期化と起動を行うスクリプト
- `stop.sh` - システムを安全に停止するためのスクリプト
- `restart.sh` - ハートビートを再起動するためのスクリプト
- `ai-docs/` - AI向けの詳細ドキュメントを格納するディレクトリ
- `themebox/` - 新しいテーマを事前準備するディレクトリ
- `artifacts/` - AIエージェントが生成した成果物を保存するディレクトリ
- `stats/` - システムの状態情報を管理するディレクトリ

この構成により、システムは最小限の人的介入で長時間にわたって自律的に動作し、継続的に思考と創造のプロセスを実行することができます。