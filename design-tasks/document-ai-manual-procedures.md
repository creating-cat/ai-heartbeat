# AI向けドキュメントの手動操作手順の明確化

## 1. 問題点 (What)

調査報告書 (`investigation-report-for-ai-manual-proceduress.md`) で指摘されている通り、
現在のAI向けドキュメント (`GEMINI.md`, `ai-docs/`) の一部で、MCPツールの使用が前提となっており、AIが自律的に判断・実行するための詳細な情報が不足している。

具体的には、以下の3点で手動での操作方法やファイルの具体的な処理内容が不明確になっている。

1.  **テーマ履歴記録の手動作成方法が不明確**
    -   `THEME_SYSTEM.md` にて、`create_theme_log` ツールを使わずに手動でテーマ履歴を記録する場合のファイルフォーマットや命名規則が記載されていない。

2.  **専門家コンテキストの手動作成方法が不明確**
    -   `ADVANCED_FEATURES.md` にて、`create_theme_expert_context` ツールを使わずに手動でコンテキストファイルを作成する場合の具体的な手順（ディレクトリ、ファイル名、フォーマット）が記載されていない。

3.  **`themebox`/`feedbackbox`の手動処理フローが不明確**
    -   `ADVANCED_FEATURES.md` にて、`check_and_process_item` ツールが内部的に行っている処理フロー（どのファイルを対象とし、読み込み、処理後にどうリネームするか）が説明されていない。

## 2. なぜやるのか (Why)

-   **AIの自律性向上**: AIがツールの内部動作を理解し、ツールに依存しない判断を下せるようにする。
-   **堅牢性の向上**: MCPツールが利用できない、またはエラーが発生した場合でも、AIがルールに従ってタスクを継続できるようにする。
-   **AIファースト設計の徹底**: AIが「迷わず、効率的に、安全に」動作できる環境を提供するため、曖昧さを排除し、明確で構造化された情報を提供する。

## 3. 修正対象 (Where)

-   `ai-works-lib/ai-docs/THEME_SYSTEM.md`
-   `ai-works-lib/ai-docs/ADVANCED_FEATURES.md`

## 4. 具体的な修正内容 (How)

調査結果に基づき、各ドキュメントに手動での操作手順を追記する。

### `THEME_SYSTEM.md` への追記内容

-   **テーマ履歴記録**のセクションに、手動で記録する場合のファイル命名規則とMarkdownフォーマットを明記する。
    -   **命名規則**: `{ID}_start_{dirPart}.md`, `{ID}_end_{dirPart}.md`
    -   **フォーマット**: テーマ開始/終了、メイン/サブテーマそれぞれのMarkdown構造を記述。

### `ADVANCED_FEATURES.md` への追記内容

1.  **専門家コンテキスト作成**のセクションに、「手動での作成方法」を追加する。
    -   **手順**: ディレクトリ作成 (`contexts/`) -> ファイル作成 (`{ハートビートID}.md`) -> 内容記述
    -   **フォーマット**: 専門家コンテキストのMarkdown構造を明記する。

2.  **`themebox`/`feedbackbox`処理**のセクションに、「手動での処理フロー」を追加する。
    -   **手順**:
        1.  未処理ファイル (`.md` で、`draft.` や `processed.` プレフィックスがない) を検索。
        2.  ファイル名でソートして最初のファイルを選択・読み込み。
        3.  処理後に `processed.` プレフィックスを付けてリネーム。

## 5. 完了の判断基準 (When)

-   [ ] `THEME_SYSTEM.md` に、テーマ履歴の手動作成方法（命名規則、フォーマット）が追記されている。
-   [ ] `ADVANCED_FEATURES.md` に、専門家コンテキストの手動作成方法（手順、フォーマット）が追記されている。
-   [ ] `ADVANCED_FEATURES.md` に、`themebox`/`feedbackbox` の手動処理フローが追記されている。
-   [ ] 追記された内容が、AIがツールなしでもタスクを遂行できるレベルで具体的かつ明確である。

## 6. 関連情報

-   **調査ソース**:
    -   `mcp/ai-heartbeat-mcp/src/tools/` 配下のツール実装
    -   `ai-works-lib.old/` 配下の古いドキュメント

## 7. 見積もり

-   工数: 0.5h
-   優先度: 中