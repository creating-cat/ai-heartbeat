# MCP警告対応ガイド

## 概要

AI心臓システム用MCP（Model Context Protocol）ツールが出力する警告メッセージへの対応方法を説明します。

## 思考ログ作成ツール（create_thinking_log）の警告

### 1. 重複ハートビートID警告

**警告メッセージ例:**
```
⚠️ ハートビートID 20250115143000 は既に存在するため、連番 01 を付与しました。
```

**直接的な原因:**
- 同一のハートビートIDで複数回ログ作成を試行している

**想定される根本原因:**
- 思考ログ作成後に、タスクを終了せず次のハートビートを待たずに、次の処理を継続してしまっている。

**この警告の影響範囲:***
- この状態が続くと、AI心臓システムの理念である「小さな一歩」が実現されていない可能性がある。

**対応方法:**
1. **タスクを終了**: 次のハートビートでの内省するために、タスクを終了してプロンプト待ち状態にして、次のハートビート受信を待機します。
2. **次のハートビートでの内省**: 以下について内省する
   - 原因の考察
     - 思考ログ作成後にタスクを終了せず処理をしてしまっていた場合があったか
     - 意図的な同一のハートビートIDでのログ作成だったか
     - その他原因について考察する
   - 事象の評価と今後の予防策について
     - 今回の事象は問題ありだったか問題なしだったか？
     - 今後の予防策が必要かどうかとその内容を検討する
3. **思考ログ作成・タスクを終了**: 今回の思考ログ作成しタスクを終了する

**予防策例:**
- 思考ログ作成後に必ずタスクを終了し、プロンプト待ち状態にして、次のハートビート受信を待機する。


### 2. 時刻乖離警告

**警告メッセージ例:**
```
ℹ️ 情報: ハートビートIDの時刻と現在時刻に 8分 の乖離があります。
⚠️ 警告: ハートビートIDの時刻と現在時刻に 12分 の乖離があります。
🚨 重大: ハートビートIDの時刻と現在時刻に 14分 の乖離があります。
```

**直接的な原因:**
- ハートビートIDの時刻と現在時刻に乖離が発生している

**想定される根本原因:**
- 処理時間の長期化による時刻差の蓄積
  - 1ハートビート内での複数処理の実行や、分割不可の長時間処理の実行
- 過去のハートビートIDを意図せず使用している

**この警告の影響範囲:**
- この状態が続くと、AI心臓システムの理念である「小さな一歩」が実現されていない可能性がある。
  - 警告レベルが高いほど長期間処理になってしまっていて、小さな積み重ねができていない可能性がある。
- ハートビートIDの間違った運用を行っている可能性がある。

**対応方法:**
1. **タスクを終了**: 次のハートビートでの内省するために、タスクを終了してプロンプト待ち状態にして、次のハートビート受信を待機します。
2. **次のハートビートでの内省**: 以下について内省する
  - 原因の考察
    - 1ハートビート内で複数処理を実行していたりしたか？
    - 長期の実行になってしまうことが意図された、分割不可の長期間処理だったり、複数処理の実行だったりしたか？
    - ハートビートIDの間違った運用を行っていないかを確認する。
    - その他原因について考察する
  - 事象の評価と今後の予防策について
    - 今回の事象は問題ありだったか問題なしだったか？
      - 分割不可の長期処理だった場合は問題なし
      - 分割可能な複数処理だった場合は効率等を踏まえて分割すべきだったかどうかを考える
    - 今後の予防策が必要かどうかとその内容を検討する
3. **思考ログ作成・タスクを終了**: 今回の思考ログ作成しタスクを終了する

**予防策:**

- 複数処理を行う場合は、効率等を考慮しつつ、複数ハートビートで分割しての対応可能かどうかを検討する


## 関連ドキュメント

- [運用詳細ガイド](OPERATION_DETAILS.md)
- [ガイドライン](GUIDELINES.md)
- [トラブルシューティングガイド](TROUBLESHOOTING_GUIDE.md)
